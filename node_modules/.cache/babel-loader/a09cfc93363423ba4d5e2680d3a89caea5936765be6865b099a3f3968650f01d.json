{"ast":null,"code":"import \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.filter.js\";\nimport \"core-js/modules/esnext.iterator.map.js\";\nimport NumberWithUnitField from '../ui/fields/NumberWithUnitField.vue';\nimport FoodicsPrimaryBtn from '../ui/buttons/FoodicsPrimaryBtn.vue';\nimport FoodicsSecondaryBtn from '../ui/buttons/FoodicsSecondaryBtn.vue';\nimport DropdownCheckboxesField from '../ui/fields/DropdownCheckboxesField.vue';\nimport TimeSlotsField from '../ui/fields/TimeSlotsField.vue';\nimport BranchOverviewModel from '@/business/models/BranchOverviewModel';\nimport BranchTableModel from '@/business/models/BranchTableModel';\nimport ReservationTimeSlotModel from '@/business/models/ReservationTimeSlotModel';\nimport ReservationsScheduleModel from '@/business/models/ReservationsScheduleModel';\nexport default {\n  name: 'EditBranchModal',\n  components: {\n    NumberWithUnitField,\n    FoodicsPrimaryBtn,\n    FoodicsSecondaryBtn,\n    DropdownCheckboxesField,\n    TimeSlotsField\n  },\n  props: {\n    modalId: {\n      type: String,\n      required: true\n    },\n    submitChanges: {\n      type: Function,\n      required: true\n    },\n    branch: {\n      type: Object,\n      required: false\n    }\n  },\n  data() {\n    return {\n      isLoading: false,\n      formData: {\n        reservationsDuration: '',\n        tables: [],\n        sunday: [],\n        monday: [],\n        tuesday: [],\n        wednesday: [],\n        thursday: [],\n        friday: [],\n        saturday: []\n      }\n    };\n  },\n  watch: {\n    branch: {\n      handler(newBranch) {\n        if (newBranch && newBranch.tables && newBranch.tables.length > 0) {\n          this.formData.tables = newBranch.tables.map((table, index) => table.isReservationAllowed ? index : -1).filter(index => index !== -1);\n        } else {\n          this.formData.tables = [];\n        }\n        if (newBranch && newBranch.reservationsSchedule) {\n          this.formData.sunday = newBranch.reservationsSchedule.sunday;\n          this.formData.monday = newBranch.reservationsSchedule.monday;\n          this.formData.tuesday = newBranch.reservationsSchedule.tuesday;\n          this.formData.wednesday = newBranch.reservationsSchedule.wednesday;\n          this.formData.thursday = newBranch.reservationsSchedule.thursday;\n          this.formData.friday = newBranch.reservationsSchedule.friday;\n          this.formData.saturday = newBranch.reservationsSchedule.saturday;\n        } else {\n          this.formData.sunday = [];\n          this.formData.monday = [];\n          this.formData.tuesday = [];\n          this.formData.wednesday = [];\n          this.formData.thursday = [];\n          this.formData.friday = [];\n          this.formData.saturday = [];\n        }\n      },\n      immediate: true\n    }\n  },\n  methods: {\n    handleFieldChange(e) {\n      const {\n        name,\n        value\n      } = e.target;\n      this.formData[name] = value;\n    },\n    async handleSubmit() {\n      this.isLoading = true;\n      const updatedTables = this.branch.tables.map((table, index) => new BranchTableModel(table.sectionName, table.sectionId, table.tableName, table.tableId, this.formData.tables.includes(index)));\n      const updatedReservations = this.mapReservationsData();\n      const updatedBranch = new BranchOverviewModel(this.branch.id, this.branch.name, this.branch.reference, updatedTables, this.formData.reservationsDuration, this.branch.isReservationsEnabled, updatedReservations);\n      await this.submitChanges(updatedBranch);\n      this.isLoading = false;\n    },\n    /**\n     * It is a helper function for handleSubmit () It maps the reservations data to the format that the model expects\n     */\n    mapReservationsData() {\n      return new ReservationsScheduleModel(this.formData.sunday.map(period => new ReservationTimeSlotModel(period.start, period.end)), this.formData.monday.map(period => new ReservationTimeSlotModel(period.start, period.end)), this.formData.tuesday.map(period => new ReservationTimeSlotModel(period.start, period.end)), this.formData.wednesday.map(period => new ReservationTimeSlotModel(period.start, period.end)), this.formData.thursday.map(period => new ReservationTimeSlotModel(period.start, period.end)), this.formData.friday.map(period => new ReservationTimeSlotModel(period.start, period.end)), this.formData.saturday.map(period => new ReservationTimeSlotModel(period.start, period.end)));\n    }\n  }\n};","map":{"version":3,"names":["NumberWithUnitField","FoodicsPrimaryBtn","FoodicsSecondaryBtn","DropdownCheckboxesField","TimeSlotsField","BranchOverviewModel","BranchTableModel","ReservationTimeSlotModel","ReservationsScheduleModel","name","components","props","modalId","type","String","required","submitChanges","Function","branch","Object","data","isLoading","formData","reservationsDuration","tables","sunday","monday","tuesday","wednesday","thursday","friday","saturday","watch","handler","newBranch","length","map","table","index","isReservationAllowed","filter","reservationsSchedule","immediate","methods","handleFieldChange","e","value","target","handleSubmit","updatedTables","sectionName","sectionId","tableName","tableId","includes","updatedReservations","mapReservationsData","updatedBranch","id","reference","isReservationsEnabled","period","start","end"],"sources":["src/View/components/modalForms/EditBranchModal.vue"],"sourcesContent":["/**\n    This component is used to display a modal for editing branch settings\n*/\n<template>\n  <div class=\"modal fade\" :id=\"modalId\" tabindex=\"-1\" :aria-labelledby=\"`${modalId}Label`\" aria-hidden=\"true\">\n    <div class=\"modal-dialog modal-size\">\n      <div class=\"modal-content\">\n        <div class=\"modal-header\">\n          <h5 class=\"modal-title\" :id=\"`${modalId}Label`\">{{ $t('editBranch') }}</h5>\n          <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\n        </div>\n        <div class=\"modal-body\">\n          <div v-if=\"!isLoading\" class=\"mb-3 row\"> <!-- Form Fields -->\n\n            <div class=\"col-sm-12 col-md-6\"> <!-- Reservations Duration -->\n              <NumberWithUnitField\n                :label=\"$t('reservationsDuration')\"\n                name=\"reservationsDuration\"\n                :value=\"formData.reservationsDuration\"\n                :unitText=\"$t('minutes')\"\n                :handleChange=\"handleFieldChange\"\n              />\n            </div>\n\n            <div class=\"col-sm-12 col-md-6\"> <!-- Tables -->\n                <DropdownCheckboxesField\n                    :label=\"$t('tables')\"\n                    name=\"tables\" \n                    :value=\"formData.tables\"\n                    :options=\"(branch && branch.tables && branch.tables.length > 0) ? branch.tables.map(table => `${table.sectionName} - ${table.tableName}`) : []\"\n                    :handleChange=\"handleFieldChange\"\n                />\n            </div>\n\n            <div class=\"col-sm-12 col-md-6\"> <!-- Sunday -->\n                <TimeSlotsField\n                    :label=\"$t('sunday')\"\n                    name=\"sunday\"\n                    :value=\"formData.sunday\"\n                    :handleChange=\"handleFieldChange\"\n                    :maxSlots=3\n                />\n            </div>\n\n            <div class=\"col-sm-12 col-md-6\"> <!-- Monday -->\n                <TimeSlotsField\n                    :label=\"$t('monday')\"\n                    name=\"monday\"\n                    :value=\"formData.monday\"\n                    :handleChange=\"handleFieldChange\"\n                    :maxSlots=3\n                />\n            </div>\n\n            <div class=\"col-sm-12 col-md-6\"> <!-- Tuesday -->\n                <TimeSlotsField\n                    :label=\"$t('tuesday')\"\n                    name=\"tuesday\"\n                    :value=\"formData.tuesday\"\n                    :handleChange=\"handleFieldChange\"\n                    :maxSlots=3\n                />\n            </div>\n\n            <div class=\"col-sm-12 col-md-6\"> <!-- Wednesday -->\n                <TimeSlotsField\n                    :label=\"$t('wednesday')\"\n                    name=\"wednesday\"\n                    :value=\"formData.wednesday\"\n                    :handleChange=\"handleFieldChange\"\n                    :maxSlots=3\n                />\n            </div>\n\n            <div class=\"col-sm-12 col-md-6\"> <!-- Thursday -->\n                <TimeSlotsField\n                    :label=\"$t('thursday')\"\n                    name=\"thursday\"\n                    :value=\"formData.thursday\"\n                    :handleChange=\"handleFieldChange\"\n                    :maxSlots=3\n                />\n            </div>\n\n            <div class=\"col-sm-12 col-md-6\"> <!-- Friday -->\n                <TimeSlotsField\n                    :label=\"$t('friday')\"\n                    name=\"friday\"\n                    :value=\"formData.friday\"\n                    :handleChange=\"handleFieldChange\"\n                    :maxSlots=3\n                />\n            </div>\n\n            <div class=\"col-sm-12 col-md-6\"> <!-- Saturday -->\n                <TimeSlotsField\n                    :label=\"$t('saturday')\"\n                    name=\"saturday\"\n                    :value=\"formData.saturday\"\n                    :handleChange=\"handleFieldChange\"\n                    :maxSlots=3\n                />\n            </div>\n            \n          </div>\n          <div v-else class=\"mb-3 text-center\">\n            <div class=\"spinner-border\" role=\"status\">\n              <span class=\"visually-hidden\">Loading...</span>\n            </div>\n          </div>\n        </div>\n        <div class=\"modal-footer\">\n          <div class=\"d-flex flex-column flex-md-row justify-content-end w-100 gap-2\">\n            <div class=\"col-sm-6 col-md-2\">\n              <FoodicsSecondaryBtn data-bs-dismiss=\"modal\" :onClick=\"() => {$emit('close')}\">{{ $t('close') }}</FoodicsSecondaryBtn>\n            </div>\n            <div class=\"col-sm-6 col-md-2\">\n              <FoodicsPrimaryBtn :onClick=\"handleSubmit\"> {{ $t('save') }} </FoodicsPrimaryBtn>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport NumberWithUnitField from '../ui/fields/NumberWithUnitField.vue'\nimport FoodicsPrimaryBtn from '../ui/buttons/FoodicsPrimaryBtn.vue';\nimport FoodicsSecondaryBtn from '../ui/buttons/FoodicsSecondaryBtn.vue';\nimport DropdownCheckboxesField from '../ui/fields/DropdownCheckboxesField.vue';\nimport TimeSlotsField from '../ui/fields/TimeSlotsField.vue';\nimport BranchOverviewModel from '@/business/models/BranchOverviewModel';\nimport BranchTableModel from '@/business/models/BranchTableModel';\nimport ReservationTimeSlotModel from '@/business/models/ReservationTimeSlotModel';\nimport ReservationsScheduleModel from '@/business/models/ReservationsScheduleModel';\n\nexport default {\n  name: 'EditBranchModal',\n  components: {\n    NumberWithUnitField,\n    FoodicsPrimaryBtn,\n    FoodicsSecondaryBtn,\n    DropdownCheckboxesField,\n    TimeSlotsField\n  },\n  props: {\n    modalId: {\n      type: String,\n      required: true\n    },\n    submitChanges: {\n      type: Function,\n      required: true\n    },\n    branch: {\n      type: Object,\n      required: false\n    }\n  },\n  data() {\n    return {\n      isLoading: false,\n      formData: {\n        reservationsDuration: '',\n        tables: [],\n        sunday: [],\n        monday: [],\n        tuesday: [],\n        wednesday: [],\n        thursday: [],\n        friday: [],\n        saturday: []\n      }\n    }\n  },\n  watch: {\n    branch: {\n      handler(newBranch) {\n        if (newBranch && newBranch.tables && newBranch.tables.length > 0) {\n          this.formData.tables = newBranch.tables\n            .map((table, index) => (table.isReservationAllowed) ? index : -1)\n            .filter(index => index !== -1);\n            \n        } else {\n          this.formData.tables = [];\n        }\n        if (newBranch && newBranch.reservationsSchedule) {\n          this.formData.sunday = newBranch.reservationsSchedule.sunday;\n          this.formData.monday = newBranch.reservationsSchedule.monday;\n          this.formData.tuesday = newBranch.reservationsSchedule.tuesday;\n          this.formData.wednesday = newBranch.reservationsSchedule.wednesday;\n          this.formData.thursday = newBranch.reservationsSchedule.thursday;\n          this.formData.friday = newBranch.reservationsSchedule.friday;\n          this.formData.saturday = newBranch.reservationsSchedule.saturday;\n        } else {\n          this.formData.sunday = []\n          this.formData.monday = []\n          this.formData.tuesday = []\n          this.formData.wednesday = []\n          this.formData.thursday = []\n          this.formData.friday = []\n          this.formData.saturday = []\n        }\n      },\n      immediate: true\n    }\n  },\n  methods: {\n    handleFieldChange(e) {\n      const { name, value } = e.target\n      this.formData[name] = value\n    },\n    async handleSubmit() {\n      this.isLoading = true\n      const updatedTables = this.branch.tables.map((table, index) => new BranchTableModel(table.sectionName, table.sectionId, table.tableName, table.tableId, this.formData.tables.includes(index)))\n      const updatedReservations = this.mapReservationsData()\n      const updatedBranch = new BranchOverviewModel(this.branch.id, this.branch.name, this.branch.reference, updatedTables, this.formData.reservationsDuration, this.branch.isReservationsEnabled, updatedReservations)\n      await this.submitChanges(updatedBranch)\n      this.isLoading = false\n    },\n    /**\n     * It is a helper function for handleSubmit () It maps the reservations data to the format that the model expects\n     */\n    mapReservationsData() {\n      return new ReservationsScheduleModel(\n        this.formData.sunday.map((period) => new ReservationTimeSlotModel(period.start, period.end)),\n        this.formData.monday.map((period) => new ReservationTimeSlotModel(period.start, period.end)),\n        this.formData.tuesday.map((period) => new ReservationTimeSlotModel(period.start, period.end)),\n        this.formData.wednesday.map((period) => new ReservationTimeSlotModel(period.start, period.end)),\n        this.formData.thursday.map((period) => new ReservationTimeSlotModel(period.start, period.end)),\n        this.formData.friday.map((period) => new ReservationTimeSlotModel(period.start, period.end)),\n        this.formData.saturday.map((period) => new ReservationTimeSlotModel(period.start, period.end))\n      )\n    },\n  }\n}\n</script>\n\n<style scoped>\n.modal-size {\n  width: 95vw;\n  min-width: 95vw;\n}\n\n@media (min-width: 768px) {\n  .modal-size {\n    width: 55vw;\n    min-width: 55vw;\n  }\n}\n.modal-header {\n  border-bottom: 1px solid #dee2e6;\n}\n\n.modal-footer {\n  border-top: 1px solid #dee2e6;\n}\n</style>\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}